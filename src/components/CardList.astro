---
import { Icon } from "astro-icon/components";

interface Props {
    title: string;
    items: Array<{
        id: string;
        title: string;
        icon?: string;
        suffix?: string;
        href: string;
    }>;
    legend?: Array<{
        icon: string;
        title: string;
    }>;
}

const { title, items, legend } = Astro.props;

// Group items by first letter
const groupedItems = items.reduce((acc, item) => {
    const firstLetter = item.title.charAt(0).toUpperCase();
    if (!acc[firstLetter]) {
        acc[firstLetter] = [];
    }
    acc[firstLetter].push(item);
    return acc;
}, {} as Record<string, typeof items>);

// Sort letters
const letters = Object.keys(groupedItems).sort();
---

<div class="card-list">
    <h1 class="card-list__title">{title}</h1>

    {legend && (
        <ul class="card-list__legend">
            {legend.map((item) => (
                <li class="card-list__legend-item">
                    <Icon name={item.icon} />
                    <span>{item.title}</span>
                </li>
            ))}
        </ul>
    )}

    <div class="card-list__content">
        {letters.map((letter) => (
            <div class="card-list__group">
                <h2 class="card-list__group-label">{letter}</h2>
                <div class="card-list__group-items">
                    {groupedItems[letter].map((item) => (
                        <a href={item.href} class="card-list__item">
                            {item.icon && (
                                <span class="card-list__item-icon">
                                    <Icon name={item.icon} />
                                </span>
                            )}
                            <span class="card-list__item-title">{item.title}</span>
                            <span class="card-list__item-suffix">
                                {item.suffix}
                            </span>
                        </a>
                    ))}
                </div>
            </div>
        ))}
    </div>
</div>

